df <- read.csv("/Users/usd-msads/Library/CloudStorage/OneDrive-UniversityofSanDiego/ADS-503/ParkinsonsPredictor_ADS503/parkinsons_updrs.data.csv")
df <- read.csv("ParkinsonsPredictor_ADS503/parkinsons_updrs.data.csv")
df <- read.csv("parkinsons_updrs.data.csv")
motor_UPDRS <-df$motor_UPDRS
total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
df_x <- df[c(2:5,8:23)]
library(caret)
library(randomForest)
library(tidyverse)
library(ggplot2)
library(earth)
library(kernlab)
theme_set(theme_minimal())
#Set seed to reproduce samples
seed <- 123
cor(df$motor_UPDRS, df$total_UPDRS)
#Evaluate data for NAs
df_x_na <- apply(df_x, 2, function(x) {sum(is.na(x))})
# Function to plot the distribution of a numeric variable
plot_numeric_distribution <- function(df_x, var_name) {
ggplot(df_x, aes_string(var_name)) +
geom_histogram(binwidth = 0.5, fill = "blue", color = "black") +
ggtitle(paste("Distribution of", var_name)) +
xlab(var_name) +
ylab("Frequency")
}
# Function to plot the distribution of a factor variable
plot_factor_distribution <- function(df_x, var_name) {
ggplot(df_x, aes_string(var_name)) +
geom_bar(fill = "blue", color = "black") +
ggtitle(paste("Distribution of", var_name)) +
xlab(var_name) +
ylab("Count")
}
# Loop through each column in the data frame and plot the distribution
for (var_name in names(df_x)) {
if (is.numeric(df_x[[var_name]])) {
print(plot_numeric_distribution(df_x, var_name))
} else if (is.factor(df_x[[var_name]])) {
print(plot_factor_distribution(df_x, var_name))
}
}
df <- read.csv("parkinsons_updrs.data.csv")
motor_UPDRS <-df$motor_UPDRS
total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
df_x <- df[c(2:5,8:23)]
library(caret)
library(randomForest)
library(tidyverse)
library(ggplot2)
library(earth)
library(kernlab)
theme_set(theme_minimal())
#Set seed to reproduce samples
seed <- 123
cor(df$motor_UPDRS, df$total_UPDRS)
df <- read.csv("parkinsons_updrs.data.csv")
motor_UPDRS <-df$motor_UPDRS
total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
df_x <- df[c(2:5,8:23)]
head(df_x)
df <- read.csv("parkinsons_updrs.data.csv")
head(df)
motor_UPDRS <-df$motor_UPDRS
total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
df_x <- df[c(2:5,8:23)]
head(df_x)
str(df)
df <- read.csv("parkinsons_updrs.data.csv")
head(df)
#motor_UPDRS <-df$motor_UPDRS
#total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
#df_x <- df[c(2:5,8:23)]
#head(df_x)
library(caret)
library(randomForest)
library(tidyverse)
library(ggplot2)
library(earth)
library(kernlab)
library(dplyr)
theme_set(theme_minimal())
#Set seed to reproduce samples
seed <- 123
df <- read.csv("parkinsons_updrs.data.csv")
head(df)
#motor_UPDRS <-df$motor_UPDRS
#total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
#df_x <- df[c(2:5,8:23)]
#head(df_x)
str(df)
df <- read.csv("parkinsons_updrs.data.csv")
head(df)
summary(df)
#motor_UPDRS <-df$motor_UPDRS
#total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
#df_x <- df[c(2:5,8:23)]
#head(df_x)
df <- read.csv("parkinsons_updrs.data.csv")
head(df)
#motor_UPDRS <-df$motor_UPDRS
#total_UPDRS <-df$total_UPDRS
#Create dataframe of predictors, removing the index and dependent variables
#df_x <- df[c(2:5,8:23)]
#head(df_x)
summary(df)
# Age distribution
ggplot(df, aes(x = age)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black") +
theme_minimal() +
labs(title = "Age Distribution of Patients", x = "Age", y = "Count")
# Total UPDRS distribution
ggplot(df, aes(x = total_UPDRS)) +
geom_histogram(binwidth = 5, fill = "green", color = "black") +
theme_minimal() +
labs(title = "Distribution of Total UPDRS Scores", x = "Total UPDRS", y = "Count")
# Age vs. Total UPDRS
ggplot(df, aes(x = age, y = total_UPDRS)) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = "Age vs. Total UPDRS", x = "Age", y = "Total UPDRS")
# Count the number of males and females
sex_count <- df %>%
group_by(sex) %>%
summarise(count = n())
# Convert 'sex' to factor for better labeling
sex_count$sex <- factor(sex_count$sex, labels = c("Female", "Male"))
# Create a bar plot for the distribution of males and females
ggplot(sex_count, aes(x = sex, y = count, fill = sex)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Distribution of Males and Females", x = "Sex", y = "Count") +
scale_fill_manual(values = c("Female" = "pink", "Male" = "blue"))
library(caret)
library(randomForest)
library(tidyverse)
library(ggplot2)
library(earth)
library(kernlab)
library(dplyr)
library(corrplot)
theme_set(theme_minimal())
#Set seed to reproduce samples
seed <- 123
corrplot(correlations, order = "hclust")
correlations <- cor(df)
corrplot(correlations, order = "hclust")
correlations <- cor(df)
corrplot(correlations, order = "hclust")
print(correlations)
sum(is.na(df))
# determine the minimum count
min_count <- min(sex_count$count)
# downsample the majority class
df_downsample <- df %>%
group_by(sex) %>%
sample_n(min_count)
# new male and female visualization
ggplot(df_downsample, aes(x = sex, y = count, fill = sex)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Distribution of Males and Females", x = "Sex", y = "Count") +
scale_fill_manual(values = c("Female" = "pink", "Male" = "blue"))
# determine the minimum count
min_count <- min(sex_count$count)
# downsample the majority class
df_downsample <- df %>%
group_by(sex) %>%
sample_n(min_count)
# Visualizing new amount of male and female
# Count the number of males and females after downsampling
sex_count_downsampled <- df_downsample %>%
group_by(sex) %>%
summarise(count = n())
# Convert 'sex' to factor for better labeling
sex_count_downsampled$sex <- factor(sex_count_downsampled$sex, labels = c("Female", "Male"))
# Create a bar plot for the distribution of males and females after downsampling
ggplot(sex_count_downsampled, aes(x = sex, y = count, fill = sex)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Distribution of Males and Females after Downsampling", x = "Sex", y = "Count") +
scale_fill_manual(values = c("Female" = "pink", "Male" = "blue"))
# gather numeric columns
numeric_cols <- sapply(df, is.numeric)
# normalizing the numerical features
df[numeric_cols] <- lapply(df[numeric_cols], scale)
# Remove high correlations
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
length(highCorr)
head(highCorr)
# Remove high correlations
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
print("The amount of high correlations:", length(highCorr), "\n")
# Remove high correlations
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
cat("The amount of high correlations:", length(high_correlation), "\n")
# Remove high correlations
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
cat("The amount of high correlations:", length(highCorr), "\n")
#length(highCorr)
head(highCorr)
# Remove high correlations
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
cat("The amount of high correlations:", length(highCorr), "\n")
#length(highCorr)
cat ("Values with high correlations: \n")
cat(highCorr)
# removing high correlations
filtered_df <- df[,-highCorr]
# correlation heatmap again
correlationsFiltered <- cor(filtered_df)
corrplot(correlationsFiltered, order = "hclust")
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
cat("The amount of high correlations:", length(highCorr), "\n")
\n
# find highly correlated predictors
highCorr <- findCorrelation(correlations, cutoff = 0.80)
cat("The amount of high correlations:", length(highCorr), "\n")
cat("\n")
cat ("Values with high correlations: \n")
cat(highCorr)
# Boxplot for each numerical variable
boxplot(df[,numeric_cols], outline=TRUE, col="lightblue", main="Boxplot of Numerical Variables")
# Boxplot for each numerical variable
boxplot(df[,numeric_cols], outline=TRUE, col="lightblue", main="Boxplot of Numerical Variables")
# Function to detect outliers using IQR method
detect_outliers <- function(x) {
q1 <- quantile(x, 0.25)
q3 <- quantile(x, 0.75)
iqr <- q3 - q1
lower_bound <- q1 - 1.5 * iqr
upper_bound <- q3 + 1.5 * iqr
outliers <- x < lower_bound | x > upper_bound
return(outliers)
}
# Apply the function to each numerical variable
outliers <- apply(df[,numeric_cols], 2, detect_outliers)
# Count the number of outliers for each variable
outlier_counts <- colSums(outliers)
outlier_counts
head(filtered_df)
View(filtered_df)
# Visualize the distribution of total_UPDRS
ggplot(filtered_df, aes(x = total_UPDRS)) +
geom_histogram(binwidth = 5, fill = "green", color = "black") +
theme_minimal() +
labs(title = "Distribution of Total UPDRS Scores", x = "Total UPDRS", y = "Count")
# Visualize the distribution of total_UPDRS with density plot
ggplot(filtered_df, aes(x = total_UPDRS)) +
geom_density(fill = "green", color = "black") +
theme_minimal() +
labs(title = "Density Plot of Total UPDRS Scores", x = "Total UPDRS", y = "Density")
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, -"total_UPDRS"]
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, -"total_UPDRS[,1]"]
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in predictor_vars) {
ggplot(filtered_df, aes_string(x = var, y = "total_UPDRS")) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
}
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in colnames(predictor_vars)) {
ggplot(filtered_df, aes(x = !!as.symbol(var), y = total_UPDRS)) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
}
library(ggplot2)
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in colnames(predictor_vars)) {
p <- ggplot(filtered_df, aes_string(x = var, y = "total_UPDRS")) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
print(p)
}
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in colnames(predictor_vars)) {
ggplot(filtered_df, aes(x = !!as.symbol(var), y = total_UPDRS)) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
}
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in colnames(predictor_vars)) {
ggplot(filtered_df, aes(x = !!as.symbol(var), y = total_UPDRS)) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
}
# Select predictor variables (all columns except total_UPDRS)
predictor_vars <- filtered_df[, !colnames(filtered_df) %in% "total_UPDRS"]
# Create scatter plots for each predictor variable against total_UPDRS
for (var in colnames(predictor_vars)) {
p <- ggplot(filtered_df, aes_string(x = var, y = "total_UPDRS")) +
geom_point(alpha = 0.5) +
theme_minimal() +
labs(title = paste("Scatter Plot of", var, "vs. Total UPDRS"),
x = var, y = "Total UPDRS")
print(p)
}
# Split the data into training and test sets (80% train, 20% test)
set.seed(123)
trainIndex <- createDataPartition(filtered_df$total_UPDRS, p = 0.8, list = FALSE)
dataTrain <- data[trainIndex, ]
# Split the data into training and test sets (80% train, 20% test)
set.seed(123)
trainIndex <- createDataPartition(filtered_df$total_UPDRS, p = 0.8, list = FALSE)
dataTrain <- filtere_df[trainIndex, ]
# Split the data into training and test sets (80% train, 20% test)
set.seed(123)
trainIndex <- createDataPartition(filtered_df$total_UPDRS, p = 0.8, list = FALSE)
dataTrain <- filtered_df[trainIndex, ]
dataTest <- filtered_df[-trainIndex, ]
# Split the data into training and test sets (80% train, 20% test)
set.seed(123)
trainIndex <- createDataPartition(filtered_df$total_UPDRS, p = 0.8, list = FALSE)
df_train <- filtered_df[trainIndex, ]
df_test <- filtered_df[-trainIndex, ]
# Print dimensions of training and test sets
cat("Training data dimensions:", dim(dataTrain), "\n")
cat("Test data dimensions:", dim(dataTest), "\n")
dim(df)
# Print dimensions of filtered dataset and original dataset
cat("Original data dimensions:", dim(df), "\n")
cat("Filtered data dimensions:", dim(filtered_df), "\n")
# Split the data into training and test sets (80% train, 20% test)
set.seed(123)
trainIndex <- createDataPartition(filtered_df$total_UPDRS, p = 0.8, list = FALSE)
df_train <- filtered_df[trainIndex, ]
df_test <- filtered_df[-trainIndex, ]
# Print dimensions of training and test sets
cat("Training data dimensions:", dim(df_train), "\n")
cat("Test data dimensions:", dim(df_test), "\n")
View(predictor_vars)
# removing high correlations
filtered_df <- df[,-highCorr]
# correlation heatmap again
correlationsFiltered <- cor(filtered_df)
corrplot(correlationsFiltered, order = "hclust")
